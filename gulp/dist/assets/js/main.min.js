for(var i=0;i<10;i++){alert(1)}sd;define(function(require){require("ifind.dialog");require("thsPage");require("autoComplete");require("app/UserInfoView");require("jquery.qrcode");require("app/messageNotify");require("app/roadShow");var e=require("laypage");var t=require("artTemplate");var a=require("./statistics");var o=require("./toolTip");var r=require("handlebars");var i=require("app/nav");var n={};var s="";var l={};n.DEFAULT={returnError:"请求返回错误",iframeUrl:"/thsft/iFindService/IStrategy/road-show/comment",ajaxList:"/thsft/iFindService/IStrategy/road-show/ajax-get-user-comment-list",introduce:"/thsft/iFindService/IStrategy/subject/ajax-agency-introduce",reportList:"/thsft/iFindService/IStrategy/finance/ajax-get-relation-user-list",reportCollectComment:"/thsft/iFindService/IStrategy/road-show/ajax-collection-comment",reportCollectHistory:"/thsft/iFindService/IStrategy/road-show/ajax-collection-record",Uncollect:"/thsft/iFindService/IStrategy/road-show/ajax-unbook-record-or-comment",roadShowCommentUrl:"/thsft/iFindService/IStrategy/road-show/view-detail",collect:"/thsft/iFindService/IStrategy/road-show/ajax-book-record-or-comment",uncollect:"/thsft/iFindService/IStrategy/road-show/ajax-unbook-record-or-comment",delete:"/thsft/iFindService/IStrategy/road-show/ajax-remove-article",historyRecordDetail:"/thsft/iFindService/IStrategy/road-show/history-record-detail",check:"/thsft/iFindService/IStrategy/road-show/ajax-get-comment-status",praise:"/thsft/iFindService/IStrategy/road-show/ajax-get-good-status",addNum:"/thsft/iFindService/fianace/ajax-read-num-acticle",address:{}};n.paramModule={dialogState:true,dialogOption:{top:30,width:900,height:450,dispose:true,overlay:true,url:n.DEFAULT.iframeUrl,opacity:.3,show:true},common:{loadingHTML:'<div id="jiazai">正在努力加载中...</div>',layerHTML:'<div class="layer"></div>',showLoading:function(e){$(this.loadingHTML).appendTo(e).show();$(this.layerHTML).appendTo(e)},removeLoading:function(){$("#jiazai").remove();$(".layer").remove()}},iframeParam:{postid:null,thsuserid:null},ajaxData:{page:1,pagesize:8,ifindid:$("#ifindid").attr("data-id")},ajaxCollectData:{page:1,pagesize:8},ajaxHistoryData:{page:1,pagesize:8},UncollectHistoryData:{id:null,type:1},UncollectAnalyseData:{id:null,type:2},deleteData:{id:null},collectAnalyseData:{id:null,type:2},collectText:{success:"取消成功",fail:"取消失败"},deleteText:{success:"删除成功",fail:"删除失败"}};n.toolModule=function(o,i){var n=i;var c=o;var d=function(){this._default=c;this._param=n};d.fn=d.prototype;d.fn.ajaxGetList=function(t,a,o,i,s,l){var d=this;if(typeof t=="number"){s.page=t}$.ajax({url:l,type:"GET",data:s,beforeSend:function(){n.common.showLoading("body")},success:function(t){n.common.removeLoading("body");var f=t;if(typeof f==="object"){if(f.errno=="0"&&f.data){var u=o.html();var m=r.compile(u);console.log(m(f));i.html(m(f.data));e({cont:a,pages:f.data.total_pages,skip:true,prev:"<",next:">",first:1,last:10,curr:f.data.page||1,jump:function(e,t){if(!t){d.ajaxGetList(e.curr,a,o,i,s,l)}}});var p=c.address.postid;var v=false;if(n.dialogState==true&&c.address.show=="cmt"){$.each($(".proRoadBox .r-cont h5"),function(){var e=$(this).parents(".r-cont").data("url");if(e==p){v=true;$(this).trigger("click")}});if(!v&&p!=undefined){Dialog.alert("当前查看的观点已被删除")}n.dialogState=false}}}else{console.warn(c.returnError)}},error:function(){n.common.removeLoading("body");console.warn(c.returnError)}})};d.fn.unCollectOrDelete=function(e,t,a,o){$.ajax({url:e,data:t,beforeSend:function(){n.common.showLoading("body")},success:function(e){n.common.removeLoading("body");if(typeof e==="object"){if(e.errno==0){Dialog.alert(o.success);a()}else{Dialog.alert(o.fail+e.error)}}else{console.error("请求失败")}},error:function(){n.common.removeLoading("body");console.error("请求失败")}})};d.fn.showDetail=function(e,t){e.preventDefault();var o=$(e.target).parents(".r-cont");var r=o.attr("data-url");if(!r){return}var i=o;i=$(e.target).parents(".road-analyse-li");var d=i.find(".pNum");var f=i.find(".upNum");var u=i.find(".r-cont");n.iframeParam.postid=r;var m=c.roadShowCommentUrl+"?"+$.param(n.iframeParam);var p=new Dialog(null,{title:"路演点评详情",top:80,width:950,height:400,move:true,overlay:true,dispose:true,url:m,onInit:function(){this.dialog.css("overflow","visible");var e=[];var o=$("#isself").val()==1||!!!$("#is-reporter").val();var i=!!!$("#is-reporter").val();if(t==true){if(!o){e.push('<span class="sb-box sb-box-col"><i class="r-col"></i><span ></span></span>')}}else{if(!i){e.push('<span class="sb-box sb-box-col"><i class="r-col"></i><span ></span></span>')}}e.push('<span class="sb-box sb-box-cmt"><i></i><span id="sb-comment"></span></span>');e.push('<span class="sb-box disable sb-box-praise"><i></i><span id="sb-praise"></span></span>');e.push('<span class="sb-box sb-box-weixin"><i></i><div class="weixin-wrapper" id="weixin">');e.push("</div></span>");e.push('<span class="sb-box sb-box-share"><a href="javascript:void(0)" class="share-tsina" data-cmd="tsina" title="分享到新浪微博"></a></span>');e.push('<span class="sb-box sb-box-share"><a href="javascript:void(0)" class="share-qzone" data-cmd="qzone" title="分享到QQ空间"></a></span>');e.push('<span class="sb-box sb-box-top"><i></i></span>');this.content.append("<div class='share-bar'>"+e.join("")+"</div>");var s=$("#weixin");var p=$('<div class="weixin-qrcode"></div>');s.append(p);s.append($("<p>扫一扫，快速分享</p>"));m="http://"+window.location.host+m;p.qrcode({width:120,height:120,text:m});var v=$("#sb-comment");var h=$("#sb-praise");var g=$(".sb-box-col");v.html(d.html());h.html(f.html());g.attr("value",u.attr("data-url"));var y=this;window.refreshParam=function(e){if(e){var t=parseInt(d.html());t++;d.html(t);v.html(t)}else{var t=parseInt(f.html());t++;f.html(t);h.html(t)}};var x=this.content.find(".sb-box-top");var b=y.content.find("iframe");var w=b.get(0).contentWindow;x.on("click",function(){$(w.document.body).animate({scrollTop:0},200)});var S=h.parent();if(l[r]){var j=l[r];if(j=="1"){S.addClass("selected")}else{S.removeClass("disable")}}else{$.ajax({url:c.praise,type:"get",data:{id:r},success:function(e){if(e.data.isparise=="1"){S.addClass("selected")}else{S.removeClass("disable")}l[r]=e.data}})}$.ajax({url:c.check,data:{id:n.iframeParam.postid},success:function(e){if(typeof e==="object"){if(e.errno==="0"){var t=e.data;if(t==="1"){g.find("i").addClass("r-select")}else{g.find("i").removeClass("r-select")}}}else{console.error("请求错误")}},error:function(){console.error("请求错误")}});$(".sb-box-col").on("click",function(e){var t="";var a=$(this).attr("value");var o=n.collectAnalyseData;var r=$(this).find("i").hasClass("r-select");if(r){t=c.uncollect}else{t=c.collect}n.collectAnalyseData.id=a;$.ajax({url:t,data:o,success:function(t){if(typeof t==="object"){if(t.errno==0){$(e.currentTarget).find("i").toggleClass("r-select");Dialog.alert(t.error)}else{Dialog.alert(t.error)}}else{consoe.error("请求发生错误")}},error:function(){console.error("请求发生错误")}})});S.on("click",function(e){e.preventDefault();var t=$(this);if(t.hasClass("disable"))return;if(t.data("praise"))return;$.ajax({url:"/thsft/iFindService/IStrategy/road-show/ajax-agree-view",type:"post",data:{id:r},success:function(){S.addClass("selected");l[r]="1";t.data("praise",true);window.refreshParam(false)}})});v.parent().on("click",function(e){var t=$(w.document.body);var a=t.find("#comment-form");var o=a.offset();var r=o.top;t.animate({scrollTop:r},200);if(w.commentForm){w.commentForm.focus()}});$(document).on("click",".sb-box-share .share-qzone",function(e){if(a&&a.ElemClick)a.ElemClick("icl_56975ff4_827","观点·QQ空间分享");$(w.document).find(".bdsharebuttonbox .bds_qzone").get(0).click()});$(document).on("click",".sb-box-share .share-tsina",function(e){if(a&&a.ElemClick)a.ElemClick("icl_56975fe8_41","观点·新浪微博分享");$(w.document).find(".bdsharebuttonbox .bds_tsina").get(0).click()})},onBeforeShow:function(){var e;if(document.documentElement.scrollHeight>document.documentElement.clientHeight){e=s+"px"}else{e="0px"}$(document.body).css({overflow:"hidden","padding-right":e})},onAfterHide:function(){$(document.body).css({overflow:"","padding-right":"0px"})}});p.show()};d.fn.getComputeScrollWidth=function(){var e=document.createElement("div");var t=e.style;t.width="100px";t.height="100px";t.overflow="auto";e.innerHTML='<div style="height:200px;width:100%"></div>';document.body.appendChild(e);var a=e.offsetWidth-e.scrollWidth;e.parentNode.removeChild(e);return a};d.fn.instrusty=function(){$("#settledPersonList").hide();var e=$("#userID").attr("data-id");$.ajax({type:"get",dataType:"json",url:c.introduce+"?ifindid="+e}).done(function(e){var t=e.data;$(".instrusty").find(".intro-company").text(t)});$.ajax({type:"get",dataType:"json",url:c.reportList+"?ifindid="+e}).done(function(e){n.common.removeLoading();if(e.data.length!=0){var a=t("settledTaPersonTemp",e.data);$("#settledPerson").html(a);$("#settledPersonList").show()}else{$("#settledPersonList").hide()}})};d.fn.changeTab=function(){var e=window.location.search;var t=c.address=this.address(e);if(e.search("show=cmt")!=-1){if(e.search("page")!=-1&&e.search("show=cmt")!=-1){n.ajaxData.page=t.page}$("#proRoad").trigger("click")}else if(e.search("show=easy")!=-1){$("#mainTab li[data-tab='myView']").trigger("click")}};d.fn.address=function(e){var t=e,a=[],o={},r,i;if(typeof t==="string"&&t.length!=0){t=t.substring(1);a=t.split("&");for(var n=0;n<a.length;n++){r=a[n].split("=")[0];i=a[n].split("=")[1];o[r]=i}}return o};d.fn.isHaveHistory=function(){var e=function(e){var t=e.localStorage;var a="message-history";return{clear:function(){t.removeItem(a)},set:function(e){t.setItem(a,e)},get:function(){var e=t.getItem(a);return e}}}(window);if(document.referrer!=""&&document.referrer!=window.location.href){if(e.get!=location.href){if(sessionStorage.getItem("indexIs")!="finance"){o()}}}else{localStorage.removeItem("historyUrl")}var t=window.location.href;var a=t.indexOf("source=StrategyManage")!=-1;if(a){o()}function o(){$("#bgManage").addClass("have-return");$("#J-info-edit").addClass("ml855");$(".hasManage").addClass("have-return");$(".goMoneyCenter").addClass("have-return");$(".return-back").show()}};d.fn.returnPrev=function(e){var t=$(e.target);localStorage.setItem("return",true);var a=window.location.href;var o=a.indexOf("source=StrategyManage")!=-1;var r=window.app&&window.app.sendMessage!==undefined;if(o){if(r){app.sendMessage("OnClientCmd",["main=Portfolio"])}else if(window.external&&window.external.OnPreviousPage){window.external.OnClientCmd("main=Portfolio")}e.preventDefault()}else{var i=localStorage.getItem("historyUrl");var n=i.split("|");var s=n.length-1;var l=n[s];if(s==0){localStorage.removeItem("historyUrl")}location.href=l}};d.fn.saveUrl=function(){var e=function(e){var t=e.localStorage;var a="message-history";return{clear:function(){t.removeItem(a)},set:function(e){t.setItem(a,e)},get:function(){var e=t.getItem(a);return e}}}(window);function t(e){if(e.indexOf("postid=")!=-1){var t=e.split("?");var a=t[1].split("&");var o=[];for(var r=0,i=a.length;r<i;r++){var n=a[r];if(n.indexOf("postid=")!=-1||n.indexOf("page=")!=-1){continue}o.push(n)}e=t[0]+"?"+o.join("&")}return e}var a=document.referrer;a=t(a);if(a&&(a.indexOf("message-reminder")!=-1||a.indexOf("submit-application")!=-1)){a=e.get()}if(localStorage.getItem("historyUrl")!=null){var o=localStorage.getItem("historyUrl");var r=o.split("|");var i=true;var n;for(var s=0;s<r.length;s++){if(r[s]==a){i=false}}if(i){if(a!=location.href){var o=o+"|"+a;localStorage.setItem("historyUrl",o);r=o.split("|");var l=r.length;for(var s=0;s<l;s++){if(r[s]==location.href){n=s}}r.splice(n,l-n);r=r.join("|");localStorage.setItem("historyUrl",r)}}}else{localStorage.setItem("historyUrl",a)}if(document.referrer==""){sessionStorage.setItem("indexIs","finance");localStorage.removeItem("historyUrl")}localStorage.setItem("currentPage","finance");localStorage.setItem("saveUrl",window.location.href);localStorage.removeItem("return")};return new d(c,n)}(n.DEFAULT,n.paramModule);var c=function(e){var t=null,a=$(document),o=e,r=o._default,i=o._param,n=o._param.dialogOption,s=null;a.on("click","#mainTab li",function(){t=$(this).attr("data-tab");s=t+"Box";$(this).addClass("cur").siblings().removeClass("cur");$("."+s).show().siblings().hide()});a.on("click",".proRoadBox .r-cont",function(e){o.showDetail(e,true)});a.on("click",".proCollectBox .r-cont",function(e){o.showDetail(e)});a.on("click","#r-history",function(){o.ajaxGetList(1,$("#collect-history-page"),$("#road-scjl-temp"),$("#collect-history"),i.ajaxHistoryData,r.reportCollectHistory)});a.on("click","#proCollect",function(){o.ajaxGetList(1,$("#collect-commont-page"),$("#road-sc-temp"),$("#collect-comment"),i.ajaxCollectData,r.reportCollectComment)});a.on("click","#proRoad",function(){if($("#report_isself").val()==1){i.ajaxData.isself=1}o.ajaxGetList(null,$("#pro-page"),$("#road-dp-temp"),$("#road-analyse"),i.ajaxData,r.ajaxList)});a.on("click",".return-back",function(e){o.returnPrev(e)});a.on("click","#introduce",function(){});a.on("click","#r-h4",function(){var e=$(this).attr("data-url");window.location.href=e});a.on("click",".r-tab li",function(){var e=$(this).attr("item");$(this).addClass("r-on").siblings().removeClass("r-on");$("."+e+"-div").show().siblings("div").hide()});a.on("click",".history-uncollect",function(){var e=this;var t=function(){var t=r.Uncollect;var a=function(){o.ajaxGetList(1,$("#collect-history-page"),$("#road-scjl-temp"),$("#collect-history"),i.ajaxHistoryData,r.reportCollectHistory)};i.UncollectHistoryData.id=$(e).attr("url-data");o.unCollectOrDelete(t,i.UncollectHistoryData,a,i.collectText)};Dialog.confirm("确定要取消收藏该路演记录吗",t)});a.on("click",".analyse-uncollect",function(){var e=this;var t=function(){var t=r.Uncollect;var a=function(){o.ajaxGetList(1,$("#collect-commont-page"),$("#road-sc-temp"),$("#collect-comment"),i.ajaxCollectData,r.reportCollectComment)};i.UncollectAnalyseData.id=$(e).attr("url-data");o.unCollectOrDelete(t,i.UncollectAnalyseData,a,i.collectText)};Dialog.confirm("确定要取消收藏该路演点评吗",t)});a.on("click",".tool-delete",function(){var e=this;var t=function(){var t=r.delete;var a=function(){o.ajaxGetList(1,$("#pro-page"),$("#road-dp-temp"),$("#road-analyse"),i.ajaxData,r.ajaxList)};i.deleteData.id=$(e).attr("postid");o.unCollectOrDelete(t,i.deleteData,a,i.deleteText)};Dialog.confirm("确定要删除该路演点评吗",t)});a.on("click",".tool-edit",function(){var e=$(this).attr("number");var t=$(this).attr("dataid");var a=r.historyRecordDetail+"?roadShowNum="+e+"&edit="+t;window.location.href=a})}(n.toolModule);var d=function(e){var t=e;s=t.getComputeScrollWidth();i.init();t.saveUrl();t.isHaveHistory();t.changeTab();o.init(".main");if($("#introduce").length){t.instrusty()}}(n.toolModule)});